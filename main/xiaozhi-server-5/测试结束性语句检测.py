#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
æµ‹è¯•ç»“æŸæ€§è¯­å¥æ£€æµ‹åŠŸèƒ½
"""

import re

def test_ending_user_input(text: str) -> bool:
    """æµ‹è¯•ç”¨æˆ·ç»“æŸæ€§è¾“å…¥æ£€æµ‹"""
    if not text or len(text.strip()) == 0:
        return False
    
    text = text.strip().lower()
    
    # ç»“æŸæ€§ç”¨æˆ·è¯è¯­æ¨¡å¼
    ending_patterns = [
        # æ„Ÿè°¢ç±»
        r'^(è°¢è°¢|æ„Ÿè°¢|å¤šè°¢|thank|thanks)(?:ä½ |æ‚¨)?[ï¼ã€‚!.]*$',
        # ç¡®è®¤ç±»  
        r'^(å¥½çš„|å¥½|è¡Œ|å¯ä»¥|æ²¡é—®é¢˜|ok|okay)(?:äº†|çš„|å•¦)?[ï¼ã€‚!.]*$',
        # ç»„åˆç¡®è®¤æ„Ÿè°¢ç±» - ğŸ¯ æ–°å¢ï¼šæ”¯æŒ"å¥½çš„è°¢è°¢"ç­‰ç»„åˆ
        r'^(å¥½çš„|å¥½|è¡Œ|å¯ä»¥)[\s,ï¼Œ]*(?:è°¢è°¢|æ„Ÿè°¢|å¤šè°¢)(?:ä½ |æ‚¨)?[ï¼ã€‚!.]*$',
        r'^(è°¢è°¢|æ„Ÿè°¢|å¤šè°¢)[\s,ï¼Œ]*(?:å¥½çš„|å¥½|è¡Œ|å¯ä»¥)(?:äº†|çš„|å•¦)?[ï¼ã€‚!.]*$',
        # å‘Šåˆ«ç±»
        r'^(å†è§|æ‹œæ‹œ|bye|goodbye|æ™šå®‰|å›å¤´è§)(?:äº†|å•¦)?[ï¼ã€‚!.]*$',
        # çŸ­ç¡®è®¤
        r'^(å—¯|å“¦|å—¯å—¯|å“¦å“¦|å—¯å“¦|å¥½å§)(?:äº†|çš„|å•¦)?[ï¼ã€‚!.]*$',
        # çŸ¥é“äº†ç±»
        r'^(çŸ¥é“äº†|æ˜ç™½äº†|æ‡‚äº†|äº†è§£äº†|æ”¶åˆ°äº†)(?:å•¦)?[ï¼ã€‚!.]*$',
        # æ²¡äº‹äº†ç±» - ğŸ¯ æ‰©å±•æ‹’ç»/ä¸éœ€è¦æ¨¡å¼
        r'^(æ²¡äº‹äº†|ç®—äº†|ä¸ç”¨äº†|ä¸è¦äº†|å–æ¶ˆ)(?:å§|å•¦)?[ï¼ã€‚!.]*$',
        r'^(ä¸éœ€è¦|ä¸ç”¨|ä¸è¦|æ²¡æœ‰)(?:ä¸éœ€è¦|ä¸ç”¨|ä¸è¦|äº†|å•¦)?[ï¼ã€‚!.]*$',  # "ä¸éœ€è¦"ã€"ä¸éœ€è¦ä¸éœ€è¦"
        r'^ä¸+[ï¼ã€‚!.]*$',  # è¿ç»­çš„"ä¸"
    ]
    
    for i, pattern in enumerate(ending_patterns):
        if re.search(pattern, text):
            print(f"âœ… åŒ¹é…æ¨¡å¼ {i+1}: {pattern}")
            return True
    
    return False

def test_ending_system_response(text: str) -> bool:
    """æµ‹è¯•ç³»ç»Ÿç»“æŸæ€§å›å¤æ£€æµ‹"""
    if not text or len(text.strip()) == 0:
        return False
    
    text = text.strip()
    
    # ç³»ç»Ÿç»“æŸæ€§å›å¤æ¨¡å¼
    ending_patterns = [
        # å‘Šåˆ«ç±» - ğŸ¯ æ‰©å±•å‘Šåˆ«æ¨¡å¼
        r'(å†è§|æ‹œæ‹œ|æ™šå®‰|å›å¤´èŠ|æœ‰éœ€è¦å†å«æˆ‘|æ˜å¤©è§|ä¸‹æ¬¡è§|å›å¤´è§|å¾…ä¼šè§)',
        r'(å’±ä»¬.*?è§|æ—¶é—´.*?å¿«|è¯¥.*?å†è§)',  # "å’±ä»¬æ˜å¤©è§"ã€"æ—¶é—´è¿‡å¾—çœŸå¿«"
        # æœåŠ¡å®Œæˆç±»
        r'(å¸®æ‚¨è®¾ç½®å¥½äº†|å·²ç»ä¸ºæ‚¨|æ“ä½œå®Œæˆ|è®¾ç½®å®Œæˆ|ä»»åŠ¡å®Œæˆ)',
        # æ— éœ€å›å¤ç±»
        r'(ä¸ç”¨å›å¤|ä¸ç”¨è°¢|åˆ«å®¢æ°”|åº”è¯¥çš„)',
        # ç¥ç¦ç±»
        r'(ç¥æ‚¨|å¸Œæœ›æ‚¨|æ„¿æ‚¨|å¥½å¥½ä¼‘æ¯|æ³¨æ„èº«ä½“|è®°å¾—.*?é˜²æš‘|å¤šå–æ°´)',
    ]
    
    for i, pattern in enumerate(ending_patterns):
        if re.search(pattern, text):
            print(f"âœ… åŒ¹é…æ¨¡å¼ {i+1}: {pattern}")
            return True
    
    return False

def main():
    """ä¸»æµ‹è¯•å‡½æ•°"""
    print("ğŸ§ª æµ‹è¯•ç»“æŸæ€§è¯­å¥æ£€æµ‹")
    print("=" * 50)
    
    # æµ‹è¯•ç”¨æˆ·è¾“å…¥
    print("\nğŸ“ ç”¨æˆ·ç»“æŸæ€§è¾“å…¥æµ‹è¯•:")
    test_cases_user = [
        "å¥½çš„è°¢è°¢",
        "è°¢è°¢å¥½çš„",
        "ä¸éœ€è¦ä¸éœ€è¦",
        "ä¸éœ€è¦",
        "ä¸è¦äº†",
        "ç®—äº†",
        "å†è§",
        "å¥½çš„",
        "è°¢è°¢ä½ ",
    ]
    
    for case in test_cases_user:
        result = test_ending_user_input(case)
        status = "âœ… PASS" if result else "âŒ FAIL"
        print(f"{status} ã€Œ{case}ã€ â†’ {result}")
    
    print("\nğŸ¤– ç³»ç»Ÿç»“æŸæ€§å›å¤æµ‹è¯•:")
    test_cases_system = [
        "æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œå’±ä»¬æ˜å¤©è§å•¦~è®°å¾—å¤šå–æ°´é˜²æš‘å“¦ï¼",
        "å¥½çš„ï¼Œè‹¥æ‚¨ä¹‹åæœ‰éœ€è¦éšæ—¶å¯ä»¥å‘Šè¯‰æˆ‘ã€‚",
        "æ˜å¤©è§ï¼Œå¥½å¥½ä¼‘æ¯",
        "ç¥æ‚¨èº«ä½“å¥åº·",
        "è®°å¾—å¤šå–æ°´é˜²æš‘",
        "æ‚¨æƒ³è®©æˆ‘ç”¨é—¹é“ƒè¿˜æ˜¯å”±æ­Œå«æ‚¨å‘€ï¼Ÿ",  # è¿™ä¸ªåº”è¯¥ä¸åŒ¹é…
    ]
    
    for case in test_cases_system:
        result = test_ending_system_response(case)
        status = "âœ… PASS" if result else "âŒ FAIL"
        print(f"{status} ã€Œ{case[:30]}...ã€ â†’ {result}")

if __name__ == "__main__":
    main()
